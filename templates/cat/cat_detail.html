{% extends 'district/base.html' %}
{% load static %}

{% block content %}
<div class="cat-detail-container">
  <div class="cat-detail-card">
    <h1 class="cat-name">{{ cat.name }}</h1>

    <div class="image-container">
      <img class="cat-photo"
           src="{% if cat.photo %}{{ cat.photo.url }}{% else %}{% static 'images/Tom_Cat_Reading_a_Newspaper.jpg' %}{% endif %}"
           alt="{{ cat.name }}">
    </div>

    <div class="cat-info">
      <p><strong>Gender:</strong> {{ cat.gender }}</p>
      <p><strong>Age:</strong> {{ cat.age }}</p>
      <p><strong>District:</strong> {{ cat.district }}</p>
      <p><strong>Last seen:</strong> {{ cat.last_seen }}</p>
      <p><strong>Last fed:</strong> {{ cat.last_fed }}</p>
      <p><strong>Last water given:</strong> {{ cat.last_water }}</p>
      <p><strong>Neutered:</strong> {{ cat.neutered }}</p>
      <p><strong>Chipped:</strong> {{ cat.chipped }}</p>
      <p><strong>Health notes:</strong> {{ cat.health_notes }}</p>
      <p><strong>Total Treatment Cost:</strong> ${{ cat.total_treatment_cost }}</p>
    </div>

    <form method="post" action="{% url 'contribute_treatment' cat.id %}" class="contribution-form">
      {% csrf_token %}
      <label for="amount">Contribution Amount ($):</label>
      <input type="number" name="amount" id="amount" min="1" step="1" required>
      <button type="submit" style="font-size: 0.6em">Contribute & Gain Karma</button>
    </form>

    {% if request.user.is_vet %}
    <div class="account-actions">
      <a href="{% url 'edit_action' cat.id %}" class="btn btn-primary">Edit health note</a>
    </div>
    {% endif %}

    <form action="{% url 'update_cat' cat.pk %}" method="get">
      <button type="submit">I saw this cat!</button>
    </form>

    {% if user.is_district_admin and user.main_district == cat.district %}
    <form method="post" style="display:inline;">
      {% csrf_token %}
      {% if not cat.approved %}
      <button type="submit" name="approve" class="btn btn-approve">Approve</button>
      {% endif %}
      <button type="submit" name="delete" class="btn btn-delete">Delete</button>
    </form>
    {% endif %}
  </div>
</div>
{% endblock %}